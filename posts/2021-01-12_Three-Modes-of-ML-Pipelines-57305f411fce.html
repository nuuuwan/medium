<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Three Modes of ML Pipelines</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Three Modes of ML Pipelines</h1>
</header>
<section data-field="subtitle" class="p-summary">
And How to improve the performance of ML Pipelines
</section>
<section data-field="body" class="e-content">
<section name="39fa" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="eb08" id="eb08" class="graf graf--h4 graf--leading graf--kicker">On Machine Learning</h4><h3 name="0581" id="0581" class="graf graf--h3 graf-after--h4 graf--title">Three Modes of ML Pipelines</h3><h4 name="25fe" id="25fe" class="graf graf--h4 graf-after--h3 graf--subtitle">And How to improve the performance of ML Pipelines</h4><p name="c0ce" id="c0ce" class="graf graf--p graf--startsWithDoubleQuote graf-after--h4"><strong class="markup--strong markup--p-strong">“What does an </strong><a href="https://medium.com/on-technology/tagged/machine-learning" data-href="https://medium.com/on-technology/tagged/machine-learning" class="markup--anchor markup--p-anchor" target="_blank"><strong class="markup--strong markup--p-strong">ML</strong></a><strong class="markup--strong markup--p-strong"> Training Pipeline look like?”</strong></p><p name="6b48" id="6b48" class="graf graf--p graf-after--p">In theory, in its simplest form, you train a model based on some data. In practice, all but the most trivial ML systems include a few more steps:</p><ol class="postList"><li name="824c" id="824c" class="graf graf--li graf-after--p">The raw data might need some preprocessing, and before you do that, you might need to inspect the data.</li><li name="8776" id="8776" class="graf graf--li graf-after--li">You might have to choose what Model to use and set the various hyperparameters of the Model.</li><li name="e3bf" id="e3bf" class="graf graf--li graf-after--li">After training the Model, you would want to evaluate it and inspect the results. Any learnings from this inspection process might influence the previous two steps.</li><li name="a8e6" id="a8e6" class="graf graf--li graf-after--li">You iterate, until the model is satisfactory.</li></ol><figure name="6a5b" id="6a5b" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*aX4gUw685lK2OA7j4x9LFA.png" data-width="1580" data-height="880" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*aX4gUw685lK2OA7j4x9LFA.png"></figure><p name="74b4" id="74b4" class="graf graf--p graf-after--figure">While even this more elaborate pipeline is somewhat simplistic, it is sufficient to explore my next question, namely, <strong class="markup--strong markup--p-strong">“How might we improve the performance of this ML Pipeline?”</strong></p><p name="ad53" id="ad53" class="graf graf--p graf-after--p">Broadly, there are three ways:</p><ol class="postList"><li name="7ae8" id="7ae8" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Better Data</strong>. ML consists of “learning” patterns in past data and using this knowledge to make decisions about the future. For example, learning how to give better product recommendations to a customer on an e-commerce site, based on that customer’s and other customers’ past behaviour. Better past data, usually helps you make better decisions about the future.</li><li name="1c77" id="1c77" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Better People.</strong> Several steps (inspecting data, model choice, inspecting results) benefit from human intelligence, knowledge and experience. Hence, the more intelligent, knowledgeable, and experienced people you have working on your ML systems, the better results you will get.</li><li name="0dcd" id="0dcd" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Better Process.</strong> While a pipeline might feel “linear” our ML Training Pipeline contains a feedback loop. Once you train a model, you evaluate it, inspect the results and iterate; until you have a good enough Model. The better you do this, the getter your models will be, and, hence, the better the performance of your ML Pipeline. In the case of this process, “better” mostly means one thing: “faster”. ML is a “search” for the best Model. And the fast you can iterate, the faster you do this search; and the quicker you’ll reach a better model.</li></ol><p name="bb80" id="bb80" class="graf graf--p graf-after--li">Which brings us to my third question: <strong class="markup--strong markup--p-strong">“How might we iterate faster?” </strong>This question finally brings us to our title topic: “Three Modes of ML Training”.</p><p name="f1d7" id="f1d7" class="graf graf--p graf-after--p">The “Three Modes” are three contrasting yet complementary ways to run the ML pipeline. When used together, they enable fast iteration, and as a result, more performant ML Pipelines.</p><h3 name="c528" id="c528" class="graf graf--h3 graf-after--p">Test Mode</h3><p name="baca" id="baca" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">What are good qualities would you expect from Unit Tests?</strong></p><p name="aa3d" id="aa3d" class="graf graf--p graf-after--p">Firstly, you’d want them to execute quickly (i.e. in a few seconds). If it took several hours for your tests to run, you’d probably give up and do something else. Secondly, you’d want them to execute “seamlessly”; for example, it would be convenient if the tests ran automatically each time you made a change or a commit; without you having to run the tests manually.</p><p name="aa03" id="aa03" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">What have Unit Tests got to do with ML Pipelines?</strong></p><p name="6244" id="6244" class="graf graf--p graf-after--p">A significant proportion of ML consists of basic software engineering. Many ML practitioners, especially those who consider ML somehow more superior to “plain programming” don’t want to admit this, but this is, nonetheless, true. You can’t build efficient ML systems if you aren’t a good software engineer (SWE). A good SWE is not just someone who writes good code, but also someone who follows other best practices like Testing.</p><p name="d811" id="d811" class="graf graf--p graf-after--p">Sadly, while Testing is vital for ML Pipelines, it is often completely ignored. The only Testing is “testing in production”. You know there is someone wrong with your ML Pipeline when it crashes.</p><p name="e268" id="e268" class="graf graf--p graf-after--p">ML Training in Test Mode consists of the following: You run every step of the ML pipeline as if it were a test. “As if it were a test” means the following:</p><ol class="postList"><li name="d976" id="d976" class="graf graf--li graf-after--p">Since tests should <strong class="markup--strong markup--li-strong">execute quickly</strong>, you modify any steps that take a lot of time. The most obvious source of slowness in an ML pipeline is the size of data. There is no way you can execute the pipeline in seconds if you need to crunch Terabytes of data. Hence, in Test Mode, you test the pipeline on a small amount of data, say a few thousand rows.</li><li name="a3fd" id="a3fd" class="graf graf--li graf-after--li">You will have all the “<a href="https://en.wikipedia.org/wiki/Hooking" data-href="https://en.wikipedia.org/wiki/Hooking" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">hooks</a>” in place to ensure that the pipeline runs in Test Mode each to a significant change is made.</li><li name="ecd9" id="ecd9" class="graf graf--li graf-after--li">You don’t expect the results of Test Mode to be of high quality. For example, a Model trained in Test Mode would not be perfect. However, you won’t expect it to be complete garbage either. Hence, you can write <strong class="markup--strong markup--li-strong">UnitTests</strong> to validate the pipeline’s various steps (like the Model produced).</li></ol><h3 name="fcc4" id="fcc4" class="graf graf--h3 graf-after--li">Human Mode</h3><p name="1260" id="1260" class="graf graf--p graf-after--h3">As we saw earlier, there are several steps in the ML Pipeline that depend on human intelligence. Human Mode makes it as easy as possible for the humans in the loop to be as intelligent as possible. Let’s look at each of the human steps in more detail.</p><ol class="postList"><li name="82d9" id="82d9" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Inspecting Data.</strong> In most ML systems, raw data is stored in vast data lakes, often on specialized servers in the cloud. While these are optimized for storage and processing, they are not optimized for humans. It is not easy for a human to get an intuition for the data on these specialized data sources. When I want to get a “feel” of the data, I download a few thousand rows of data to my local machine and use a combination of standard tools (e.g. Excel) and custom scripts to slice and dice the data. If the data involves images, video, audio and media, I will build a basic dashboard for inspecting the data.</li><li name="2bca" id="2bca" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Model Choices.</strong> When you first tackle an ML problem, you usually don’t know what algorithm is best. For example, you might want to choose between Boosting and a Neural Net. Even for a single type of algorithm (say a Neural Net), you might not know what Hyper-Parameters (e.g. The number of layers) are optimal. Human mode should make it easy to A) try out, and B) validate many choices quickly. “A)” is enabled by different algorithms having a common interface. “B)”, similar to Test Mode, is enabled by training and validating models on a smaller set of local data. You could afford a little more time for the models to train than in TestMode; but you can’t afford hours, as the humans involved would get bored. Hence, like the data inspection step, you’d want your data to live locally, or in someplace where access is fast.</li><li name="2b56" id="2b56" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Inspecting Results.</strong> In many ways, this is similar to Inspecting Data. You want the humans in the loop for getting a sense of how the models are doing. This involves looking at the data in more detail than a few performance metrics. For example, judging a model on False Positive/Negative Rates or a Confusion Matrix might be insufficient. Instead, the human inspector would want to see what types of features led to False Positives, and what led to Negatives. Like Inspecting Data, this would involve a lot of visualization, custom dashboards and slicing/dicing at will.</li></ol><p name="14ba" id="14ba" class="graf graf--p graf-after--li">There are more and more automated Test Mode tools, but few effective tools for Human Mode; probably because each human and ML problem is different. Humans need to be allowed to apply creativity and adapt. The best ML organizations are those that perfect Human Mode.</p><h3 name="d11c" id="d11c" class="graf graf--h3 graf-after--p">Production Mode</h3><p name="6e87" id="6e87" class="graf graf--p graf-after--h3">Production Mode is the final Model in the ML Pipeline. By this time, almost all the productive work is complete. Test Mode ensures that the code and other steps work properly. Human Mode ensures that humans have applied their human intelligence and expertise to solve the problem. All that remains is to train the final production model. This almost always involves running the entire pipelines just once, without iteration. These steps rarely need to repeat, or we need to go back to the Human or Test Mode, usually when some specific data breaks the pipeline.</p><p name="a731" id="a731" class="graf graf--p graf-after--p">Sadly, many ML pipelines operate only in Production Mode. “Testing in Production” slows down development significantly, and the lack of Human Mode means that models are hardly optimal.</p><h3 name="9ccb" id="9ccb" class="graf graf--h3 graf-after--p">Some Concluding Thoughts</h3><p name="a1da" id="a1da" class="graf graf--p graf-after--h3">Having different modes requires some initial investment and thought, but is well worth it — the gains in speed more than make up for the initial cost. Also, many of the principles behind these “modes” make future development more efficient. For example, adhering to “common interface” described in Human Mode make it easy to apply the same pipeline to new problems. Contrastingly, when the only mode available is Production Mode, pipelines need to be rebuilt for every problem.</p><p name="f698" id="f698" class="graf graf--p graf-after--p graf--trailing">The organizations that have perfected the “Art of the ML Pipeline”, have completely Automated Test Mode and Production Mode. Hence, humans only need to focus on Human Mode; which makes sense because that is the step that depends on Human Intelligence. They also tend to attract the best human ML experts because such experts have the opportunity to exercise their expertise and creativity. In contrast, organizations stuck in Production Mode force their humans to be machines, and waste time drudging in mundane tasks.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@nuwans" class="p-author h-card">Nuwan I. Senaratna</a> on <a href="https://medium.com/p/57305f411fce"><time class="dt-published" datetime="2021-01-12T07:44:44.220Z">January 12, 2021</time></a>.</p><p><a href="https://medium.com/@nuwans/three-modes-of-ml-pipelines-57305f411fce" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 4, 2021.</p></footer></article></body></html>